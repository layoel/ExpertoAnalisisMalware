PortEx Analyzer

Report For muestra6.bin
***********************

file size 0x25450
full path /home/remnux/Desktop/lab/malware/pe/muestra6/muestra6.bin

Section Table
*************
                         1. UPX0         2. UPX1         3. .rsrc       
-------------------------------------------------------------------------
Entropy                  0.00            7.99            2.68           
Pointer To Raw Data      0x400           0x400           0x24000        
Size Of Raw Data         0x0             0x23c00         0x600          
Physical End             0x400           0x24000         0x24600        
Virtual Address          0x1000          0x29000         0x4d000        
Virtual Size             0x28000         0x24000         0x1000         
Pointer To Relocations   0x0             0x0             0x0            
Number Of Relocations    0x0             0x0             0x0            
Pointer To Line Numbers  0x0             0x0             0x0            
Number Of Line Numbers   0x0             0x0             0x0            
Initialized Data                         x               x              
Uninitialized Data       x                                              
Execute                  x               x                              
Read                     x               x               x              
Write                    x               x               x              

MSDOS Header
************

description                            value          file offset    
---------------------------------------------------------------------
signature word                         0x5a4d         0x0            
last page size                         0x90           0x2            
file pages                             0x3            0x4            
relocation items                       0x0            0x6            
header paragraphs                      0x4            0x8            
minimum number of paragraphs allocated 0x0            0xa            
maximum number of paragraphs allocated 0xffff         0xc            
initial SS value                       0x0            0xe            
initial SP value                       0xb8           0x10           
complemented checksum                  0x0            0x12           
initial IP value                       0x0            0x14           
pre-relocated initial CS value         0x0            0x16           
relocation table offset                0x40           0x18           
overlay number                         0x0            0x1a           
Reserved word 0x1c                     0x0            0x1c           
Reserved word 0x1e                     0x0            0x1e           
Reserved word 0x20                     0x0            0x20           
Reserved word 0x22                     0x0            0x22           
OEM identifier                         0x0            0x24           
OEM information                        0x0            0x26           
Reserved word 0x28                     0x0            0x28           
Reserved word 0x2a                     0x0            0x2a           
Reserved word 0x2c                     0x0            0x2c           
Reserved word 0x2f                     0x0            0x2e           
Reserved word 0x30                     0x0            0x30           
Reserved word 0x32                     0x0            0x32           
Reserved word 0x34                     0x0            0x34           
Reserved word 0x36                     0x0            0x36           
Reserved word 0x38                     0x0            0x38           
Reserved word 0x3a                     0x0            0x3a           
PE signature offset                    0xe0           0x3c           

COFF File Header
****************

time date stamp  Feb 26, 2011 2:37:24 PM
machine type     Intel 386 or later processors and compatible processors
characteristics  * Image only, Windows CE, and Windows NT and later.
                 * Image only.
                 * COFF line numbers have been removed. DEPRECATED
                 * COFF symbol table entries for local symbols have been removed. DEPRECATED
                 * Machine is based on a 32-bit-word architecture.

description                          value          file offset    
-------------------------------------------------------------------
machine type                         0x14c          0xe4           
number of sections                   0x3            0xe6           
time date stamp                      0x4d690214     0xe8           
pointer to symbol table (deprecated) 0x0            0xec           
number of symbols (deprecated)       0x0            0xf0           
size of optional header              0xe0           0xf4           
characteristics                      0x10f          0xf6           

Optional Header
***************

Magic Number: PE32, normal executable file
Entry Point is in section 2 with name UPX1
No DLL Characteristics
Subsystem:           The Windows graphical user interface (GUI) subsystem

standard field                       value            file offset      
-----------------------------------------------------------------------
magic number                         0x10b            0xf8             
major linker version                 0x6              0xfa             
minor linker version                 0x0              0xfb             
size of code                         0x24000          0xfc             
size of initialized data             0x1000           0x100            
size of unitialized data             0x28000          0x104            
address of entry point               0x4bf30          0x108            
address of base of code              0x29000          0x10c            
address of base of data              0x4d000          0x110            

windows field                        value            file offset      
-----------------------------------------------------------------------
image base                           0x400000         0x114            
section alignment in bytes           0x1000           0x118            
file alignment in bytes              0x200            0x11c            
major operating system version       0x6              0x120            
minor operating system version       0x4              0x122            
major image version                  0xa              0x124            
minor image version                  0x3              0x126            
major subsystem version              0x4              0x128            
minor subsystem version              0x0              0x12a            
win32 version value (reserved)       0x0              0x12c            
size of image in bytes               0x4e000          0x130            
size of headers                      0x1000           0x134            
checksum                             0x2f3d0          0x138            
subsystem                            0x2              0x13c            
dll characteristics                  0x0              0x13e            
size of stack reserve                0x100000         0x140            
size of stack commit                 0x1000           0x144            
size of heap reserve                 0x100000         0x148            
size of heap commit                  0x1000           0x14c            
loader flags (reserved)              0x0              0x150            
number of rva and sizes              0x10             0x154            

data directory          rva              -> offset        size             in section       file offset      
-------------------------------------------------------------------------------------------------------------
import table            0x4d398          0x24398          0x110            3 .rsrc          0x160            
resource table          0x4d000          0x24000          0x398            3 .rsrc          0x168            
certificate table       0x24800          0x23c00          0xc50            1 UPX0           0x178            

Imports
*******

KERNEL32.DLL
------------
[Memory Management] <Virtual Memory>
rva: 0x4d3f0, va: 0x44d3e8, hint: 0, name: VirtualProtect -> Changes the access protection on a region of committed pages in the virtual address space of the calling process.
rva: 0x4d3f4, va: 0x44d3e8, hint: 0, name: VirtualAlloc -> Reserves or commits a region of pages in the virtual address space of the calling process.
rva: 0x4d3f8, va: 0x44d3e8, hint: 0, name: VirtualFree -> Releases or decommits a region of pages within the virtual address space of the calling process.

[Dynamic-Link Library] 
rva: 0x4d3e8, va: 0x44d3e8, hint: 0, name: LoadLibraryA -> Maps the specified executable module into the address space of the calling process.
rva: 0x4d3ec, va: 0x44d3e8, hint: 0, name: GetProcAddress -> Retrieves the address of an exported function or variable from the specified DLL.

[Process and Thread] <Process>
rva: 0x4d3fc, va: 0x44d3e8, hint: 0, name: ExitProcess -> Ends the calling process and all its threads.


advapi32.dll
------------
[Other]
rva: 0x4d404, va: 0x44d404, hint: 0, name: CloseTrace


user32.dll
----------
[Keyboard Input] 
rva: 0x4d40c, va: 0x44d40c, hint: 0, name: ToAscii -> no description


Resources
*********

offset: 0x1f5a8, size: 0x528, language -> ID: 1033, name -> ID: 3, type -> ID: RT_BITMAP
offset: 0x1fad0, size: 0x11, language -> ID: 1033, name -> ID: 1, type -> ID: RT_MENU
offset: 0x1fae4, size: 0xafe, language -> ID: 1033, name -> ID: 5, type -> ID: RT_DIALOG
offset: 0x205e4, size: 0x2e, language -> ID: 1033, name -> ID: 4, type -> ID: RT_STRING
offset: 0x20614, size: 0x2e, language -> ID: 1033, name -> ID: 6, type -> ID: RT_STRING
offset: 0x241ac, size: 0x1ec, language -> ID: 1033, name -> ID: 1, type -> ID: RT_VERSION


Version Information
*******************

VS_FIXEDFILEINFO
----------------
signature: 0xfeef04bd
binary version:  1.0
file version: 524291.0
product version: 524291.0
file flags mask: 0x3f
file flags: 0x0
file OS: Windows NT, 32-bit Windows
file type: application
file subtype: 0
file date: 0.0

StringFileInfo
---------------
language ID: 0x0409
code page: 0x04B0
CompanyName: StarNet Communications Corp. 
FileDescription: Tee Gaily Bonn 
FileVersion: 8.3 
InternalName: Offend Sin Baron 

Overlay
*******

Overlay at offset 0x24600
Overlay size      0xe50

Signatures: 
none

Anomalies
*********

* Deprecated Characteristic in COFF File Header: IMAGE_FILE_LINE_NUMS_STRIPPED
* Deprecated Characteristic in COFF File Header: IMAGE_FILE_LOCAL_SYMS_STRIPPED
* Optional Header: Size of Headers should be 1024, but is 0x1000
* Optional Header: size of code is too large (0x24000), it should be 0x0
* Optional Header: size of initialized data is too small (0x1000), it should be 0x24200
* Optional Header: size of uninitialized data is too large (0x28000), it should be 0x0
* Section Header 1 with name UPX0: POINTER_TO_RAW_DATA must be 0 for sections with only uninitialized data, but is: 1024
* Section Header 1 with name UPX0: SIZE_OF_RAW_DATA is 0
* Section name UPX0 is typical for UPX packer
* Section name UPX1 is typical for UPX packer
* Section 1 with name UPX0 (range: 1024--1024) physically overlaps with section UPX1 with number 2 (range: 1024--147456)
* Section 1 with name UPX0 has write and execute characteristics.
* Section 2 with name UPX1 has write and execute characteristics.
* Entry point is in writeable section 2 with name UPX1
* Section Header 3 with name .rsrc has unusual characteristics, that shouldn't be there: Write
* Resources are fractionated!

PEID Signatures
***************

[UPX 2.93 - 3.00 [LZMA] -> Markus Oberhumer, Laszlo Molnar & John Reiser] bytes matched: 44 at address: 0x23330
pattern:  60 be ?? ?? ?? ?? 8d be ?? ?? ?? ?? 57 89 e5 8d 9c 24 ?? ?? ?? ?? 31 c0 50 39 dc 75 fb 46 46 53 68 ?? ?? ?? ?? 57 83 c3 04 53 68 ?? ?? ?? ?? 56 83 c3 04 53 50 c7 03 03 00 02 00 90 90 90 90 90
[UPX v1.25 (Delphi) Stub] bytes matched: 8 at address: 0x23330
pattern:  60 be 00 ?? ?? 00 8d be 00 ?? ?? ff

Hashes
******

MD5:    50ea80fd625cfbb549d4cfd60056268a
SHA256: 63de57e12e6f79486ad7c65aa44fb7cbcd0bf72011ca11d0ae78a2219db3a518

Section      Type      Hash Value                                                      
---------------------------------------------------------------------------------------
1. UPX0      MD5                                                                       
             SHA256                                                                    
2. UPX1      MD5       40e4a083afd0a108db396748425059d8                                
             SHA256    f11f5637631946a5e90ae8135e703f9ba605a257bbd800fb8ee737ed48405b22
3. .rsrc     MD5       7ce5dcf721a771522543ca147671b0d3                                
             SHA256    c661daec7867cbbb272843de076fbd2fe33f5e6f9aa9dd8dc5d6aabdd2f99eda

--- end of report ---

creating visualization...
picture successfully created and saved to /home/remnux/Desktop/lab/malware/pe/muestra6.jpg

