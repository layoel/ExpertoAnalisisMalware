# Experto en Ingeniería Inversa e Inteligencia Malware

## Análisis Estático de malware

El análisis estático se trata de analizar el fichero, intentar obtener el máximo de información posible solo analizando ese fichero sin llegar a ejecutarlo.

### Muestra 2:

#### Identificación

- Inicialmente tenemos que saber que **tipo de archivo** es. PE, DLL...
con portex obtenemos
- Su **Hash**
- El **imphash**
- el **ssdeep**
los dos últimos nos identifican la familia a la que pertenece la muestra.
- Comprobar si es .exe o .dll, si es .exe no esperaremos mucha info en la tabla de exportaciones y si es dll hay información en la tabla de importaciones.

#### Extraer indicadores

- host:  solo repercuten en la máquina
	- claves de registro
	- rutas de fichero
	- nombres de ficheros
- red
	- rutas de dominio
	- protocolos que intenta usar para conectarse a un dominio concreto

herramientas: strings floss devuelven los nombres de las librerías

#### Indicadores PE

- Funciones API: filtrar las que considero por funcionalidad que tienen relación con la funcionalidad sospechosa del malware. Marcar y comentar en una linera.
- Busqueda de malformaciones: pueden hacernos sospechar empaquetamiento (tamaño en disco menor que el tamaño en memoria), ver que el entri point está dentro de la secion funciones, exportaciones (en caso de dll),  
- Busqueda de llamadas anónimas (funciones de la API sin nombre ni ordinal)
- Recursos: si hay ficheros embebidos, binarios, shelcode, datos cifrados...
- Firmas: abrir con hexadecimal y ver codigo binario parsear pkcs7 me llevo la info y lo parseo con un parseador pkcs7 y ver si sobre información...
- Entropia: de secciones y de recursos
- % de tamaño de seccion y de recurso con respecto a la totalidad del fichero. PEstudio lo hace. si un recurso tiene un 94% del fichero sospecha que el resto del ejecutable desempaqueta y ejecuta ese recurso.
- Secciones en las que no esperamos que aparezca el flag de escritura y sin embargo aparece (seccion .text con flag de escritura)
- 

¿Como sabemos si es un ejecutable o una DLL?

### Muestra 3:

#### Identificación

- Inicialmente tenemos que saber que **tipo de archivo** es. PE, DLL...
con portex obtenemos
- Su **Hash**
- El **imphash**
- el **ssdeep**
los dos últimos nos identifican la familia a la que pertenece la muestra.
- Comprobar si es .exe o .dll, si es .exe no esperaremos mucha info en la tabla de exportaciones y si es dll hay información en la tabla de importaciones.

#### Extraer indicadores

- host:  solo repercuten en la máquina
	- claves de registro
	- rutas de fichero
	- nombres de ficheros
- red
	- rutas de dominio
	- protocolos que intenta usar para conectarse a un dominio concreto

herramientas: strings floss devuelven los nombres de las librerías

#### Indicadores PE

- Funciones API: filtrar las que considero por funcionalidad que tienen relación con la funcionalidad sospechosa del malware. Marcar y comentar en una linera.
- Busqueda de malformaciones: pueden hacernos sospechar empaquetamiento (tamaño en disco menor que el tamaño en memoria), ver que el entri point está dentro de la secion funciones, exportaciones (en caso de dll),  
- Busqueda de llamadas anónimas (funciones de la API sin nombre ni ordinal)
- Recursos: si hay ficheros embebidos, binarios, shelcode, datos cifrados...
- Firmas: abrir con hexadecimal y ver codigo binario parsear pkcs7 me llevo la info y lo parseo con un parseador pkcs7 y ver si sobre información...
- Entropia: de secciones y de recursos
- % de tamaño de seccion y de recurso con respecto a la totalidad del fichero. PEstudio lo hace. si un recurso tiene un 94% del fichero sospecha que el resto del ejecutable desempaqueta y ejecuta ese recurso.
- Secciones en las que no esperamos que aparezca el flag de escritura y sin embargo aparece (seccion .text con flag de escritura)
- 

### Muestra 6:

#### Identificación

- Inicialmente tenemos que saber que **tipo de archivo** es. PE, DLL...
con portex obtenemos
- Su **Hash**
- El **imphash**
- el **ssdeep**
los dos últimos nos identifican la familia a la que pertenece la muestra.
- Comprobar si es .exe o .dll, si es .exe no esperaremos mucha info en la tabla de exportaciones y si es dll hay información en la tabla de importaciones.

#### Extraer indicadores

- host:  solo repercuten en la máquina
	- claves de registro
	- rutas de fichero
	- nombres de ficheros
- red
	- rutas de dominio
	- protocolos que intenta usar para conectarse a un dominio concreto

herramientas: strings floss devuelven los nombres de las librerías

#### Indicadores PE

- Funciones API: filtrar las que considero por funcionalidad que tienen relación con la funcionalidad sospechosa del malware. Marcar y comentar en una linera.
- Busqueda de malformaciones: pueden hacernos sospechar empaquetamiento (tamaño en disco menor que el tamaño en memoria), ver que el entri point está dentro de la secion funciones, exportaciones (en caso de dll),  
- Busqueda de llamadas anónimas (funciones de la API sin nombre ni ordinal)
- Recursos: si hay ficheros embebidos, binarios, shelcode, datos cifrados...
- Firmas: abrir con hexadecimal y ver codigo binario parsear pkcs7 me llevo la info y lo parseo con un parseador pkcs7 y ver si sobre información...
- Entropia: de secciones y de recursos
- % de tamaño de seccion y de recurso con respecto a la totalidad del fichero. PEstudio lo hace. si un recurso tiene un 94% del fichero sospecha que el resto del ejecutable desempaqueta y ejecuta ese recurso.
- Secciones en las que no esperamos que aparezca el flag de escritura y sin embargo aparece (seccion .text con flag de escritura)
- 